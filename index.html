<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge; chrome=1"/>

    <title>Data Science Salary</title>
    
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://rawgit.com/susielu/d3-annotation/master/d3-annotation.min.js"></script>
</head>

<style>
svg {
 font: 16px"Avenir";

}
  div.tooltip {	
    position: absolute;			
    text-align: center;			
    width: 200px;					
    height: 30px;					
    padding: 2px;				
    font: 12px sans-serif;		
    background: lightsteelblue;	
    border: 0px;		
    border-radius: 8px;			
    pointer-events: none;			
  }
.button-1 {
  background-color : #cccccc;
  border-radius: 8px;
  border-style: none;
  box-sizing: border-box;
  color: #FFFFFF;
  cursor: pointer;
  display: inline; //inline-block
  font-family: "Haas Grot Text R Web", "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 14px;
  font-weight: 500;
  height: 40px;
  line-height: 20px;
  list-style: none;
  margin: 0;
  outline: none;
  padding: 10px 16px;
  position: relative;
  text-align: center;
  text-decoration: none; //transition: color 100ms;
  vertical-align: middle; //baseline
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
}
.button-1:hover,
.button-1:focus {
  background-color: #EA4C89; //background-color: #F082AC;
}

</style>

<body>
<div id='introduction'>
      <p style="text-align:center;"><img src="image/free-icon-data-analysis-1643996.png" alt="icon image" style="height:50px;"></p>
      <h2 style="text-align:center">TOP SALARY JOB IN DATA SCIENCE SINCE 2020</h2>
</div>
<div id='information'>
     <p style="text-align:center;> This dashboard is based on survey that ...</p>
</div>
<div id="charts">
  <input id="default"
	 name="updateButton1" 
           	type="button" autofocus
		class="button-1"	   
           	value="SHOW 2020" />
		   
	<input name="updateButton2" 
           type="button" 
	   class="button-1"
           value="SHOW 2021" />
		   
	<input name="updateButton3" 
           type="button"
	   class="button-1"
           value="SHOW 2022" />
	
</div>
<p id = "Year" hidden>Year</p>
<p id = "Type" hidden>Type</p>

<script>
    document.getElementById("default").click();
	
    //var svg = d3.select("svg"),
    width = 800
    height = 600
    
    var svg = d3.select("body")
    .append("svg").attr("id","bubble")
    .attr("width", width)
    .attr("height", height)

    var div = d3.select("body").append("div")	
    .attr("class", "tooltip")				
    .style("opacity", 0);
  
    svg.append("text")
    .attr("x", 10)   //100
    .attr("y", 40 ) //20
    .style("font-size", "20px")  
    .style("font-weight", "bold")
    .text("DATA SCIENCE SALARY IN 2020")
    .attr("text-anchor", "start")
    //.attr("dy", "3.5em" )  

    var pack = d3.pack()
    .size([width-150, height])
    .padding(1.5);

    Year = "2020"
    File = "data/job_salary_agg_" + Year + ".csv"
    //'https://myevertime.github.io/narrative-viz/data/job_salary_agg.csv'

    d3.csv(File, function(d) {
  	d.value = +d["salary"];
  	d.job_title = d["jobTitle"]
 	return d;
	}, 
	function(error, data) {
        console.log(error);
	console.log(data);

	var color = d3.scaleOrdinal()
  	.domain(data.map(function(d){ return d.value;}))
  	.range(['#fbb4ae','#b3cde3','#ccebc5','#decbe4','#fed9a6',
  	'#ffe9a8','#b9bfe3','#fddaec','#cccccc']);
	
  	var root = d3.hierarchy({children: data})
      	.sum(function(d) { return d.value; })

  	var node = svg.selectAll(".node")
    	.data(pack(root).leaves())
    	.enter().append("g")
      	.attr("class", "node")
      	.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });
  
  	node.append("circle")
      	.attr("id", function(d) { return d.id; })
      	.attr("r", function(d) { return d.r; }) //d.r;
	.style("fill", function(d) { return color(d.data.job_title); })
      	.on("mouseover", function(d) {		
    		div.transition()		
      		.duration(200)		
      		.style("opacity", .9);
      	
    
      		var duration = 300;
  		data.forEach(function(d, i) {
    			console.log(d.value);
    			node.transition().duration(duration).delay(i * duration)
        		.attr("r", d.value * 0.0003);
		});

    		div.html(d.data.job_title + ": <br>"+d.data.value)	
      		.style("left", (d3.event.pageX) + "px")		
     		.style("top", (d3.event.pageY - 28) + "px");	
  	})					
    	.on("mouseout", function(d) {		
    		div.transition()		
      		.duration(500)		
      		.style("opacity", 0);	
  	});
     
  
   	node.append("text")
	.attr("text-anchor", "middle")
	.attr("font-size", "12px")
      	.text(function(d) {
     	if (d.data.value > 0){
       	return d.data.job_title;
     	}
     	return "";});
  

  	var legend = svg.selectAll(".legend")
  	.data(data).enter()
  	.append("g")
  	.attr("class","legend")
  	.attr("transform", "translate(" + 600 + "," + 120+ ")"); // 780,120
     
 
   	legend.append("rect")
     	.attr("x", 0) 
     	.attr("y", function(d, i) { return 20 * i; })
     	.attr("width", 15)
     	.attr("height", 15)
	.style("fill", function(d) { return color(d.job_title)});
   

    	legend.append("text")
     	.attr("x", 24) 
    	.attr("text-anchor", "start")
     	.attr("dy", "1em") 
     	.attr("y", function(d, i) { return 20 * i; })
     	.text(function(d) {return d.job_title;})
    	.attr("font-size", "12px"); 
  
      
    	legend.append("text")
     	.attr("x",31)
     	.attr("dy", "-.2em")
     	.attr("y",-10)
     	.text("Job Title")
  	.attr("font-size", "14px"); 
   	});

</script>
</body>
</html>









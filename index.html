<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge; chrome=1"/>

    <title>Data Science Salary</title>
    
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://rawgit.com/susielu/d3-annotation/master/d3-annotation.min.js"></script>
</head>

<style>
</style>
<svg width="960" height="960" font-family="sans-serif" font-size="10" text-anchor="middle"></svg>

<body>

<script>
    var svg = d3.select("svg"),
    width = +svg.attr("width"),
    height = +svg.attr("height");
  
    svg.append("text")
    .attr("x", 100)   
    .attr("y", 20 )
    .attr("dy", "3.5em" )  
    .style("font-size", "28px")  
  	.style("font-weight", "bold")
    .text("DATA SCIENCE SALARY IN 2020")
    //.attr("text-anchor", "start")

    var pack = d3.pack()
    .size([width-150, height])
    .padding(1.5);
    
    d3.csv('https://myevertime.github.io/narrative-viz/data/job_salary_agg.csv', function(d) {
  	d.value = +d["2020"];
  	d.job_title = d["jobTitle"]
 	return d;
	}, 
	function(error, data) {
        console.log(error);
	console.log(data);
		
	
  	var root = d3.hierarchy({children: data})
      	.sum(function(d) { return d.value; })

  	var node = svg.selectAll(".node")
    	.data(pack(root).leaves())
    	.enter().append("g")
      	.attr("class", "node")
      	.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });
 
  
  	node.append("circle")
      	.attr("id", function(d) { return d.id; })
      	.attr("r", function(d) { return d.r; })
      	//.on("mouseover", function(d) {		
    	//div.transition()		
      	//.duration(200)		
      	//.style("opacity", .9);	
      	//.style("fill", function(d) { return color(d.data.job_title); })
    
      	var duration = 300;
  	data.forEach(function(d, i) {
    	console.log(d.value);
    	node.transition().duration(duration).delay(i * duration)
        .attr("r", d.value);});
     
  
   	node.append("text")
      	.text(function(d) {
     	if (d.data.value > 0){
       	return d.data.job_title;
     	}
     	return "";});
  

  	var legend = svg.selectAll(".legend")
  	.data(data).enter()
  	.append("g")
  	.attr("class","legend")
  	.attr("transform", "translate(" + 780 + "," + 120+ ")");
     
 
   	legend.append("rect")
     	.attr("x", 0) 
     	.attr("y", function(d, i) { return 20 * i; })
     	.attr("width", 15)
     	.attr("height", 15)
	//.style("fill", function(d) { return color(d.job_title)});
   

    	legend.append("text")
     	.attr("x", 25) 
    	.attr("text-anchor", "start")
     	.attr("dy", "1em") 
     	.attr("y", function(d, i) { return 20 * i; })
     	.text(function(d) {return d.job_title;})
    	.attr("font-size", "12px"); 
  
      
    	legend.append("text")
     	.attr("x",31) 
     	.attr("dy", "-.2em")
     	.attr("y",-10)
     	.text("Job Title")
  	.attr("font-size", "17px"); 
   	});

</script>
</body>
</html>








